import{r as ref,b as reactive,aa as onMounted,o as openBlock,k as createElementBlock,t as toDisplayString,O as normalizeClass,az as withKeys,aA as withModifiers,ax as toRaw}from"./antdv.415263d7.js";import{m as markdownCommand}from"./NotionView.7fbebf1e.js";import{_ as _export_sfc}from"./_plugin-vue_export-helper.cdc0426e.js";import"./index.d0653a71.js";const hxCom_vue_vue_type_style_index_0_scoped_ac381864_lang="",_hoisted_1=["onKeydown","contenteditable","placeholder"],_sfc_main={__name:"hxCom",props:{config:Object,configItem:{type:Object,default:()=>({type:"p",html:""})},order:Number,readOnly:{type:Boolean,default:!1},focusOrder:Number},emits:["removeConfigItem","addConfigItem","setFocusOrder","updateConfigItem"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,hx=ref(null),state=reactive({value:"",isActive:!1,markeDownCommand:markdownCommand});onMounted(()=>{hx.value.innerHTML=props.configItem.html,console.log(props.focusOrder,props.order,props.focusOrder===props.order),props.focusOrder===props.order&&setAnchorPosition(hx.value)});function setAnchorPosition(e){e.focus();var o=document.createRange();o.selectNodeContents(e),o.collapse(!1);var t=window.getSelection();t.anchorOffset==0&&(t.removeAllRanges(),t.addRange(o))}function changeSpace(){console.log("space",state.value)}function hasCommand(e){return e.type!=="p"}function changeEnter(){let config=markdownCommand.default,html=hx.value.innerHTML;if(Object.keys(markdownCommand).map(command=>{if(hx.value.innerHTML.startsWith(command)){config=markdownCommand[command];const reg=eval("/"+command+"/gi");html=html.replace(reg,"")}}),hasCommand(config)){emit("updateConfigItem",{order:props.order,config:{...toRaw(props.configItem),html}}),emit("setFocusOrder",props.order);return}config.html="",emit("addConfigItem",{order:props.order+1,config:toRaw(config)}),emit("setFocusOrder",props.order+1)}return(e,o)=>(openBlock(),createElementBlock("div",{class:normalizeClass(["editable-true",__props.configItem.type]),ref_key:"hx",ref:hx,onKeydown:[withKeys(withModifiers(changeEnter,["prevent"]),["enter"]),withKeys(changeSpace,["enter","space"])],contenteditable:!__props.readOnly,onInput:o[0]||(o[0]=(...t)=>e.inputText&&e.inputText(...t)),placeholder:__props.configItem.type},toDisplayString(__props.configItem.html),43,_hoisted_1))}},hxCom=_export_sfc(_sfc_main,[["__scopeId","data-v-ac381864"]]);export{hxCom as default};
